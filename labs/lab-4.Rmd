---
title: "Lab 4: Probability Distributions"
output: 
  html_document: 
    theme: cosmo
    toc: yes
    toc_depth: 3
    toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# suppress scientific notation
options(scipen = 999)

# load packages
library(tidyverse)
library(magrittr)
library(psych)
library(gganimate)
```

# Purpose

Today we will be exploring the world of probability distributions. The content of the lab will be split into two sections: The first half will discuss binomial and multinomial distributions. The second half will discuss normal distributions. At the end, we will briefly discuss other types of distributions. The Minihacks will ask you to put to test

Today's lab will cover:

1. [Binomial Distributions](#binomial)
1. [The panes of RStudio](#rstudio)
1. [How to create and use R Markdown Documents](#rmarkdown)
1. [Arithmetic commands](#ac)

***

# Binomial and Multinomial Distributions {#binomial}

```{r, echo = FALSE}
# preallocate memory for flip data
binom_hist <- data.frame(event  = 1,
                         flip   = 1, 
                         result = rbinom(1, 1, 1/2))



for (i in 2:100) {
  binom_hist <- rbind(binom_hist,
                        data.frame(event  = rep(i, i),
                                   flip   = 1:i, 
                                   result = c(subset(binom_hist, event == i - 1)$result,
                                              rbinom(1, 1, 1/2))))
}


binom_hist %>%
  mutate(result = if_else(result == 1, "Heads", "Tails")) %>%
  ggplot(aes(x = result, fill = result)) +
    geom_bar(width = .5) +
    scale_fill_manual(values = c("turquoise3",
                                 "darkorchid4")) +
    transition_reveal(event) +
    theme_bw(base_size = 16) +
    theme(legend.position = "none") +
    labs(y = "Frequency",
         x = "",
         caption = "Number of flips {frame_along}")


```



```{r}
x <- seq(1, 100, 1)
likelihood <- dbinom(x, 100, 1/2)
sim <- data.frame(x, likelihood)


data <- data.frame(x    = rep(x, times = 100),
                   y    = rep(x, each  = 100),
                   prob = rep(likelihood, 100))

pp <- ggplot(data, aes(x, y, colour = prob)) +
  geom_point(size = 3) +
  scale_fill_viridis_c(option = "C")

plot_gg(pp, width = 5, height = 4, scale = 300, multicore = TRUE, windowsize = c(1000, 800))
render_camera(fov = 70, zoom = 0.5, theta = 130, phi = 35)
render_snapshot(clear = TRUE)


x <- seq(1, 100, 1)
likelihood <- dbinom(x, 100, 1/2)
sim <- data.frame(x, likelihood)
plot1 <- ggplot(sim, aes(x, likelihood)) +
  geom_line(size = 1.5, colour = "cyan3") +
  geom_point(size = 3,  colour = "cyan3") +
  labs(x       = "Number of Heads: {as.integer(frame_along)}",
       y       = "Probability") +
  theme_bw(base_size = 15) 


plot_gg(pp, width = 5, height = 4, scale = 300, multicore = TRUE, windowsize = c(1000, 800))
render_camera(fov = 70, zoom = 0.5, theta = 130, phi = 35)
render_snapshot(clear = TRUE)
```

```{r}
set.seed(2)
flips <- seq(1, 1000, 1)

sim <- data.frame(flips = flips, prop = map_dbl(flips, ~mean(rbinom(n    = .x, 
                                                                    size = 1, 
                                                                    prob = 1/2))))

plot2 <- ggplot(sim, aes(x = flips, y = prop, colour = prop)) +
  geom_line(size = 1) +
  labs(x       = "Number of Flips: {as.integer(frame_along)}",
       y       = "Proportion of Heads") +
  scale_colour_gradient2(low = "cyan3", mid = "cyan",
  high = "cyan3", midpoint = 0.5) +
  theme_bw(base_size = 15) +
  scale_y_continuous(limits = c(0, 1)) +
  transition_reveal(flips)

animate(plot2, nframes = 120, fps = 12)
```

## rbinom

Flip 2 coins 10 times

```{r}
rbinom(10, 2, 1/2)

mean(rbinom(10, 2, 1/2))

mean(rbinom(100000, 2, 1/2))

hist(rbinom(10, 1, 1/2))
```


## pbinom

What's the probability of getting one or less heads of flipping two coins with a 50/50 chance of getting a heads
```{r}
pbinom(1, 2, 1/2)
```

What's the probability of getting more than one head of flipping two coins with a 50/50 chance of getting a heads
```{r}
pbinom(1, 2, 1/2, lower.tail = FALSE)
```

## qbinom
What is the minimum value that has a 100% probability of occuring with 100 coin flips
```{r}
qbinom(1, 100, 1/2)
```

What is the minimum value that has a 75% probability of occuring with 100 coin flips
```{r}
qbinom(.75, 100, 1/2)
```

What is the minimum value that has a 50% probability of occuring with 100 coin flips
```{r}
qbinom(.50, 100, 1/2)
```

What is the minimum value that has a 25% probability of occuring with 100 coin flips
```{r}
qbinom(.25, 100, 1/2)
```

What is the minimum value that has a 25% probability of occuring with 100 coin flips
```{r}
qbinom(.25, 100, 1/2, lower.tail = FALSE)
```

## dbinom

What's the probability of getting one head of flipping one coin with a 50/50 chance of getting a heads
```{r}
dbinom(1, 1, 1/2)
```

What's the probability of getting one heads of flipping two coins with a 50/50 chance of getting a heads
```{r}
dbinom(1, 2, 1/2)
```

What's the probability of getting two heads of flipping two coins with a 50/50 chance of getting a heads
```{r}
dbinom(2, 2, 1/2)
```

What's the probability of getting two heads of flipping one coins with a 50/50 chance of getting a heads
```{r}
dbinom(2, 1, 1/2)
```


# Normal Distributions


## rnorm (most popular)

Drawn 10 values from a normal distribution with a mean of 0 and an sd of 1
```{r}
rnorm(10, mean = 0, sd = 1)

hist(rnorm(10, mean = 0, sd = 1))
hist(rnorm(1000, mean = 0, sd = 1))

```

```{r}
set.seed(2)
samples <- c(1, 5, 10, 15, 25, 50, 100, 250, 500, 750, 1000, 10000)

sim <- map_df(samples, ~data_frame(sample_size = rep(.x, .x), sample = rnorm(.x, mean = 0, sd = 1)))

plot3 <- ggplot(sim, aes(x = sample)) +
  geom_histogram(fill = "turquoise3", colour = "white", alpha = .7) +
  theme_bw(base_size = 15) +
  labs(x        = "x",
       y        = "Frequency",
       title    = "Sample Histogram",
       subtitle = "Sample Size: {closest_state}") + 
  scale_x_continuous(limits = c(-4, 4))  + 
  transition_states(sample_size, state_length = 2, wrap = FALSE) +
  view_follow(fixed_x = TRUE)

animate(plot3, nframes = 180, fps = 12)
```

```{r}
mean(rnorm(1000, mean = 0, sd = 1))

mean(rnorm(1000, mean = 10, sd = 1))

sd(rnorm(1000, mean = 0, sd = 1))

sd(rnorm(1000, mean = 0, sd = 10))
```

## pnorm
```{r}
x <- seq(-4, 4, 0.001)
likelihood <- dnorm(x, 0, 1)
sim <- data.frame(x, likelihood)
ggplot(sim, aes(x, likelihood)) +
    stat_function(fun = dnorm, 
                xlim = c(-5,0),
                geom = "area",
                fill = "turquoise3") +
  geom_line(size = 1.2) +
  theme_bw()
```

```{r}
ball_plot <- function(q, lower.tail = TRUE){
  if (lower.tail == TRUE) {
  discretized <- data.frame(x = qnorm(ppoints(100), 0, 1)) %>% 
  mutate(include = ifelse(x <= q, "no", "yes"))
  } else {
  discretized <- data.frame(x = qnorm(ppoints(100), 0, 1)) %>% 
  mutate(include = ifelse(x >= q, "no", "yes"))
  }

ggplot(discretized, aes(x)) +
  geom_dotplot(aes(fill = include), binwidth = 0.29, alpha = .7, colour = "white") +
  geom_vline(xintercept = q, color = "firebrick", linetype = 2, size = 1.4) +
  scale_fill_manual(
    values = c("turquoise3", "gray40"),
    guide = "none") +
  theme_bw() +
  scale_y_continuous(name = "", 
                     breaks = NULL)
}
```

```{r}
ball_plot(0)
```

What's the probabiltiy of getting 0 or less when the mean is 0 and the sd = 1
```{r}
pnorm(0, mean = 0, sd = 1)
```

What's the probabiltiy of getting 1 or less when the mean is 0 and the sd = 1 (50 + half of 68)

```{r}
ball_plot(1)
```

```{r}
pnorm(1, mean = 0, sd = 1)
```

What's the probabiltiy of getting -1 or less when the mean is 0 and the sd = 1 (100 - 68 /2 )
```{r}
ball_plot(-1)
```

```{r}
pnorm(-1, mean = 0, sd = 1)
```

What's the probabiltiy of getting 2 or greater when the mean is 0 and the sd = 1 
```{r}
ball_plot(2, lower.tail = FALSE)
```

```{r}
pnorm(2, mean = 0, sd = 1, lower.tail = FALSE)
```


## qnorm 

for probability .50
```{r}
ball_plot(0)
```

```{r}
qnorm(0.5, 0, 1)
pnorm(0.2533471, 0, 1)
```

for probability .975
```{r}
ball_plot(qnorm(0.975, 0, 1))
```

```{r}
qnorm(0.975, 0, 1)
```

for probability .97 upper
```{r}
ball_plot(qnorm(0.975, 0, 1), lower.tail = FALSE)
```

```{r}
qnorm(0.975, 0, 1, lower.tail = FALSE)
```

## dnorm

```{r}
dnorm_plot <- function(value) {
  ggplot(sim, aes(x, likelihood)) +
  geom_line(size = 1.2) +
  geom_segment(x = -4, 
               xend = value, 
               y = dnorm(value, mean = 0, sd = 1),
               yend = dnorm(value, mean = 0, sd = 1), 
               color = "turquoise3", 
               linetype = 2, 
               size = 1.4) +
  geom_segment(x = value, 
               xend = value, 
               y = 0,
               yend = dnorm(value, mean = 0, sd = 1), 
               color = "turquoise3", 
               linetype = 2, 
               size = 1.4) +
  annotate(geom = "label", x = value + .8, y = dnorm(value, mean = 0, sd = 1), label = round(dnorm(value, mean = 0, sd = 1), 3), colour = "turquoise3", size = 5) +
  geom_point(aes(x = value, y = dnorm(value, mean = 0, sd = 1)), size = 5, colour = "turquoise3") +
  scale_x_continuous(limits = c(-4, 4)) +
  theme_bw(base_size = 16)
}
```

Probability of a zero

```{r}
dnorm_plot(0)
```

```{r}
dnorm(0, mean = 0, sd = 1)
```

Probability of a 1

```{r}
dnorm_plot(1)
```

```{r}
dnorm(1, mean = 0, sd = 1)
```


Probability of -2

```{r}
dnorm_plot(-2)
```

```{r}
dnorm(-2, mean = 0, sd = 1)
```

***

# Minihacks {#minihacks}

Now that we have covered the lab material, we will move on to the Minihacks. You are welcome to work with a partner or in a small group of 2-3 people. If you have any questions, I would be happy to answer them!

## Minihack 1: Binomial Distributions

1. 

## Minihack 2: Normal Distributions

## Minihack 3: Other Distributions

1. My collaborater wants me to calculate a p-value for her, but I've sworn off null hypothesis testing. Fortunately, I was in the middle of writing this lab when I received her email. Use the `pchisq()` function to calculate the p-value for her Chi-Square test. She told me the following information about the test:
the chi-square value (`q`) was `1.00` 
there were `10` degrees of freedom (`df`)

```{r}
pchisq(3, 10, lower.tail = FALSE)
```


1. My collaborator just emailed me back and told me that she wasn't trying to calculate a p-value for a chi-square-test. She was trying to calculate a p-value for a t-test. I told her that I don't know any functions for t-tests, but she told me to Google it. Google (or take an educated guess) at how to calculate a p-value for my collaborator

```{r}
pt(3, 10, lower.tail = FALSE)
```

1. My collaborator also likes to mess with me and sometimes switches around letters in my code. The following code is calculating the cumulative probability of getting a value of `5` from a uniform distribution, but I want it to get the specific probability of getting a value of `5` from a uniform distribution. 

```{r}
dunif(x = 5, min = 0, max = 10)
```


